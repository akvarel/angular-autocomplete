!function(e,t){"function"==typeof define&&define.amd?define(["module","angular"],function(e,n){e.exports=t(n)}):"object"==typeof module?module.exports=t(require("angular")):(e.mp||(e.mp={}),e.mp.deepBlur=t(e.angular))}(this,function(e){"use strict";function t(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}return e.module("mp.deepBlur",[]).directive("deepBlur",["$timeout",function(e){return{restrict:"A",controller:["$scope","$element","$attrs",function(n,r,u){function o(r){var u=r.relatedTarget||r.explicitOriginalTarget||document.activeElement;t(a,u)||e(function(){n.$apply(i)},10)}var i=u.deepBlur,a=r[0];a.addEventListener?a.addEventListener("blur",o,!0):a.attachEvent("onfocusout",o)}]}}])});
function directiveFunc(){var e=function(e,t,o){function n(e){for(var t,o=e.parent(),n=o.children(),a=1;a<n.length;a++)n[a]===e[0]&&(t=n[a-1]);return t}t.find("input").on("keydown",function(o){var a=null;if(13===o.keyCode&&angular.element(t.children()[2].querySelector(".collection-item.active")).triggerHandler("click"),40===o.keyCode|38===o.keyCode&&(a=angular.element(t.children()[2]).children(),0!==a.length)){var l=t.children()[2].querySelector(".collection-item.active"),i=!0;angular.element(l).length>0&&(i=!1),l=angular.element(l).length>0?l:a[0],40===o.keyCode?i?angular.element(l).addClass("active").children("span").css("color","white"):(angular.element(l).removeClass("active").children("span").css("color",e.color),angular.element(l).next().addClass("active").children("span").css("color","white")):38===o.keyCode&&(angular.element(l).removeClass("active").children("span").css("color",e.color),angular.element(n(angular.element(l))).addClass("active").children("span").css("color","white"))}})};return{restrict:"E",replace:!0,scope:{autoData:"=",sourceLink:"=",acTitle:"=",color:"=",inputModel:"="},link:e,controller:autocompleteController,template:'<div ng-init="init()"  deep-blur="changeShowVariable(false)" style="position:relative;"><style>  input[type=text]:focus:not([readonly])#auto-complete-id{    border-bottom:1px solid {{color}} !important;    box-shadow:0 1px 0 0 {{color}} !important;  }  #auto-complete-label.active{    color:{{color}} !important;  }  .collection-item.active{    background-color:{{color}} !important;  }</style><div class="input-field">  <input type="text" id="auto-complete-id" ng-model="inputModel" ng-model-onblur ng-change="textChange()" ng-focus="changeShowVariable(true)">  <label id="auto-complete-label" for="auto-complete-id"><span ng-bind="acTitle"></span></label></div><div class="collection" ng-show="showList()" style="margin-top: -1%;position:absolute;width:100%;z-index:99;">  <a class="collection-item" ng-repeat="item in getData()" ng-click="chooseItem(item)"><span style="color:{{color}};" ng-bind="item"></span></a></div></div>'}}function autocompleteController(e){e.inputModel="",e.dataType=0,e.dataToList=[],e.showListFlag=!1,e.init=function(){void 0!==e.autoData&&e.autoData.length>0?e.dataType=1:void 0!==e.sourceLink&&""!==e.sourceLink&&(e.dataType=2)},e.changeShowVariable=function(t){t?t=0!==e.dataType&&0!==e.inputModel.length:e.chooseItemFlag&&(t=!0),e.showListFlag=t},e.showList=function(){return e.showListFlag},e.getData=function(){if(e.dataToList=[],1===e.dataType)for(var t=0;t<e.autoData.length;t++)-1!==e.autoData[t].indexOf(e.inputModel)&&e.dataToList.push(e.autoData[t]);return 0===e.dataToList.length&&(e.showListFlag=!1),e.dataToList},e.chooseItem=function(t){e.inputModel=t,e.showListFlag=!1},e.textChange=function(){e.showListFlag=0!==e.dataType&&0!==e.inputModel.length},e.showTitle=function(){return void 0!==e.title&&0!==e.length}}function autoServiceFunction(e,t){var o={getData:function(o){var n=t.defered();return e.get(o).then(function(e){n.resolve(e)},function(e){n.reject()}),n.promise}};return o}angular.module("auto-complete",["mp.deepBlur"]),angular.module("auto-complete").directive("autoCompleteInput",directiveFunc),directiveFunc.$inject=[],autocompleteController.$inject=["$scope"],angular.module("auto-complete").service("autoService",autoServiceFunction),autoServiceFunction.$inject=["$http","$q"];